---
source: tests/grammar/alpha040.rs
expression: parse_unwrap(&tokenize(&stdlib))
---
[
    (
        Statement(
            (
                Comment(
                    (
                        DocString(
                            "Sums an array's contents",
                        ),
                        0..29,
                    ),
                ),
                0..29,
            ),
        ),
        0..29,
    ),
    (
        FunctionDefinition(
            [
                (
                    AllowAbsurdCast,
                    29..49,
                ),
            ],
            (
                true,
                50..53,
            ),
            (
                "fun",
                54..57,
            ),
            (
                "math_sum",
                58..66,
            ),
            [
                (
                    Typed(
                        (
                            false,
                            67..67,
                        ),
                        (
                            "list",
                            67..71,
                        ),
                        (
                            [Num],
                            73..78,
                        ),
                    ),
                    67..78,
                ),
            ],
            Some(
                (
                    Num,
                    81..84,
                ),
            ),
            [
                (
                    Return(
                        (
                            "return",
                            91..97,
                        ),
                        Some(
                            (
                                Cast(
                                    (
                                        Command(
                                            [
                                                (
                                                    Trust,
                                                    98..103,
                                                ),
                                            ],
                                            [
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    104..105,
                                                ),
                                                (
                                                    Text(
                                                        "echo \"",
                                                    ),
                                                    105..112,
                                                ),
                                                (
                                                    Expression(
                                                        (
                                                            Var(
                                                                (
                                                                    "list",
                                                                    113..117,
                                                                ),
                                                            ),
                                                            113..117,
                                                        ),
                                                    ),
                                                    112..118,
                                                ),
                                                (
                                                    Text(
                                                        "\" | awk '",
                                                    ),
                                                    118..127,
                                                ),
                                                (
                                                    Text(
                                                        "\\{",
                                                    ),
                                                    127..129,
                                                ),
                                                (
                                                    Text(
                                                        "s=0; for (i=1; i<=NF; i++) s+=",
                                                    ),
                                                    129..159,
                                                ),
                                                (
                                                    Text(
                                                        "\\$",
                                                    ),
                                                    159..161,
                                                ),
                                                (
                                                    Text(
                                                        "i; print s}' ",
                                                    ),
                                                    161..174,
                                                ),
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    174..175,
                                                ),
                                            ],
                                            None,
                                        ),
                                        98..175,
                                    ),
                                    (
                                        "as",
                                        176..178,
                                    ),
                                    (
                                        Num,
                                        179..182,
                                    ),
                                ),
                                98..182,
                            ),
                        ),
                    ),
                    91..182,
                ),
            ],
        ),
        29..184,
    ),
    (
        Statement(
            (
                Comment(
                    (
                        DocString(
                            "Returns a number, rounded to the nearest integer",
                        ),
                        186..239,
                    ),
                ),
                186..239,
            ),
        ),
        186..239,
    ),
    (
        FunctionDefinition(
            [
                (
                    AllowAbsurdCast,
                    239..259,
                ),
            ],
            (
                true,
                260..263,
            ),
            (
                "fun",
                264..267,
            ),
            (
                "math_round",
                268..278,
            ),
            [
                (
                    Typed(
                        (
                            false,
                            279..279,
                        ),
                        (
                            "number",
                            279..285,
                        ),
                        (
                            Num,
                            287..290,
                        ),
                    ),
                    279..290,
                ),
            ],
            Some(
                (
                    Num,
                    293..296,
                ),
            ),
            [
                (
                    IfCondition(
                        (
                            "if",
                            303..305,
                        ),
                        (
                            IfCondition(
                                (
                                    Gt(
                                        (
                                            Var(
                                                (
                                                    "number",
                                                    306..312,
                                                ),
                                            ),
                                            306..312,
                                        ),
                                        (
                                            Number(
                                                (
                                                    0.0,
                                                    315..316,
                                                ),
                                            ),
                                            315..316,
                                        ),
                                    ),
                                    306..316,
                                ),
                                (
                                    Block(
                                        [],
                                        [
                                            (
                                                Return(
                                                    (
                                                        "return",
                                                        327..333,
                                                    ),
                                                    Some(
                                                        (
                                                            Cast(
                                                                (
                                                                    Command(
                                                                        [
                                                                            (
                                                                                Trust,
                                                                                334..339,
                                                                            ),
                                                                        ],
                                                                        [
                                                                            (
                                                                                Text(
                                                                                    "$",
                                                                                ),
                                                                                340..341,
                                                                            ),
                                                                            (
                                                                                Text(
                                                                                    "echo \"(",
                                                                                ),
                                                                                341..349,
                                                                            ),
                                                                            (
                                                                                Expression(
                                                                                    (
                                                                                        Var(
                                                                                            (
                                                                                                "number",
                                                                                                350..356,
                                                                                            ),
                                                                                        ),
                                                                                        350..356,
                                                                                    ),
                                                                                ),
                                                                                349..357,
                                                                            ),
                                                                            (
                                                                                Text(
                                                                                    "+0.5)/1\" | bc ",
                                                                                ),
                                                                                357..371,
                                                                            ),
                                                                            (
                                                                                Text(
                                                                                    "$",
                                                                                ),
                                                                                371..372,
                                                                            ),
                                                                        ],
                                                                        None,
                                                                    ),
                                                                    334..372,
                                                                ),
                                                                (
                                                                    "as",
                                                                    373..375,
                                                                ),
                                                                (
                                                                    Num,
                                                                    376..379,
                                                                ),
                                                            ),
                                                            334..379,
                                                        ),
                                                    ),
                                                ),
                                                327..379,
                                            ),
                                        ],
                                    ),
                                    317..385,
                                ),
                            ),
                            306..385,
                        ),
                        [],
                        None,
                    ),
                    303..385,
                ),
                (
                    Return(
                        (
                            "return",
                            391..397,
                        ),
                        Some(
                            (
                                Cast(
                                    (
                                        Command(
                                            [
                                                (
                                                    Trust,
                                                    398..403,
                                                ),
                                            ],
                                            [
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    404..405,
                                                ),
                                                (
                                                    Text(
                                                        "echo \"(",
                                                    ),
                                                    405..413,
                                                ),
                                                (
                                                    Expression(
                                                        (
                                                            Var(
                                                                (
                                                                    "number",
                                                                    414..420,
                                                                ),
                                                            ),
                                                            414..420,
                                                        ),
                                                    ),
                                                    413..421,
                                                ),
                                                (
                                                    Text(
                                                        "-0.5)/1\" | bc ",
                                                    ),
                                                    421..435,
                                                ),
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    435..436,
                                                ),
                                            ],
                                            None,
                                        ),
                                        398..436,
                                    ),
                                    (
                                        "as",
                                        437..439,
                                    ),
                                    (
                                        Num,
                                        440..443,
                                    ),
                                ),
                                398..443,
                            ),
                        ),
                    ),
                    391..443,
                ),
            ],
        ),
        239..445,
    ),
    (
        Statement(
            (
                Comment(
                    (
                        DocString(
                            "Returns the largest integer less than or equal to a number",
                        ),
                        447..510,
                    ),
                ),
                447..510,
            ),
        ),
        447..510,
    ),
    (
        FunctionDefinition(
            [
                (
                    AllowAbsurdCast,
                    510..530,
                ),
            ],
            (
                true,
                531..534,
            ),
            (
                "fun",
                535..538,
            ),
            (
                "math_floor",
                539..549,
            ),
            [
                (
                    Typed(
                        (
                            false,
                            550..550,
                        ),
                        (
                            "number",
                            550..556,
                        ),
                        (
                            Num,
                            558..561,
                        ),
                    ),
                    550..561,
                ),
            ],
            Some(
                (
                    Num,
                    564..567,
                ),
            ),
            [
                (
                    Return(
                        (
                            "return",
                            574..580,
                        ),
                        Some(
                            (
                                Cast(
                                    (
                                        Command(
                                            [
                                                (
                                                    Trust,
                                                    581..586,
                                                ),
                                            ],
                                            [
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    587..588,
                                                ),
                                                (
                                                    Text(
                                                        "echo \"",
                                                    ),
                                                    588..595,
                                                ),
                                                (
                                                    Expression(
                                                        (
                                                            Var(
                                                                (
                                                                    "number",
                                                                    596..602,
                                                                ),
                                                            ),
                                                            596..602,
                                                        ),
                                                    ),
                                                    595..603,
                                                ),
                                                (
                                                    Text(
                                                        "\" | awk '",
                                                    ),
                                                    603..612,
                                                ),
                                                (
                                                    Text(
                                                        "\\{",
                                                    ),
                                                    612..614,
                                                ),
                                                (
                                                    Text(
                                                        "printf \"%d\", (",
                                                    ),
                                                    614..628,
                                                ),
                                                (
                                                    Text(
                                                        "\\$",
                                                    ),
                                                    628..630,
                                                ),
                                                (
                                                    Text(
                                                        "1 < 0 ? int(",
                                                    ),
                                                    630..642,
                                                ),
                                                (
                                                    Text(
                                                        "\\$",
                                                    ),
                                                    642..644,
                                                ),
                                                (
                                                    Text(
                                                        "1) - 1 : int(",
                                                    ),
                                                    644..657,
                                                ),
                                                (
                                                    Text(
                                                        "\\$",
                                                    ),
                                                    657..659,
                                                ),
                                                (
                                                    Text(
                                                        "1))}' ",
                                                    ),
                                                    659..665,
                                                ),
                                                (
                                                    Text(
                                                        "$",
                                                    ),
                                                    665..666,
                                                ),
                                            ],
                                            None,
                                        ),
                                        581..666,
                                    ),
                                    (
                                        "as",
                                        667..669,
                                    ),
                                    (
                                        Num,
                                        670..673,
                                    ),
                                ),
                                581..673,
                            ),
                        ),
                    ),
                    574..673,
                ),
            ],
        ),
        510..675,
    ),
    (
        Statement(
            (
                Comment(
                    (
                        DocString(
                            "Returns the smallest integer greater than or equal to a number",
                        ),
                        677..744,
                    ),
                ),
                677..744,
            ),
        ),
        677..744,
    ),
    (
        FunctionDefinition(
            [
                (
                    AllowAbsurdCast,
                    744..764,
                ),
            ],
            (
                true,
                765..768,
            ),
            (
                "fun",
                769..772,
            ),
            (
                "math_ceil",
                773..782,
            ),
            [
                (
                    Typed(
                        (
                            false,
                            783..783,
                        ),
                        (
                            "number",
                            783..789,
                        ),
                        (
                            Num,
                            791..794,
                        ),
                    ),
                    783..794,
                ),
            ],
            Some(
                (
                    Num,
                    797..800,
                ),
            ),
            [
                (
                    Return(
                        (
                            "return",
                            807..813,
                        ),
                        Some(
                            (
                                Add(
                                    (
                                        FunctionInvocation(
                                            [],
                                            (
                                                "math_floor",
                                                814..824,
                                            ),
                                            [
                                                (
                                                    Var(
                                                        (
                                                            "number",
                                                            825..831,
                                                        ),
                                                    ),
                                                    825..831,
                                                ),
                                            ],
                                            None,
                                        ),
                                        814..832,
                                    ),
                                    (
                                        Number(
                                            (
                                                1.0,
                                                835..836,
                                            ),
                                        ),
                                        835..836,
                                    ),
                                ),
                                814..836,
                            ),
                        ),
                    ),
                    807..836,
                ),
            ],
        ),
        744..838,
    ),
    (
        Statement(
            (
                Comment(
                    (
                        DocString(
                            "Returns the absolute value of a number",
                        ),
                        840..883,
                    ),
                ),
                840..883,
            ),
        ),
        840..883,
    ),
    (
        FunctionDefinition(
            [
                (
                    AllowAbsurdCast,
                    883..903,
                ),
            ],
            (
                true,
                904..907,
            ),
            (
                "fun",
                908..911,
            ),
            (
                "math_abs",
                912..920,
            ),
            [
                (
                    Typed(
                        (
                            false,
                            921..921,
                        ),
                        (
                            "number",
                            921..927,
                        ),
                        (
                            Num,
                            929..932,
                        ),
                    ),
                    921..932,
                ),
            ],
            Some(
                (
                    Num,
                    935..938,
                ),
            ),
            [
                (
                    IfCondition(
                        (
                            "if",
                            945..947,
                        ),
                        (
                            InlineIfCondition(
                                (
                                    Lt(
                                        (
                                            Var(
                                                (
                                                    "number",
                                                    948..954,
                                                ),
                                            ),
                                            948..954,
                                        ),
                                        (
                                            Number(
                                                (
                                                    0.0,
                                                    957..958,
                                                ),
                                            ),
                                            957..958,
                                        ),
                                    ),
                                    948..958,
                                ),
                                (
                                    Return(
                                        (
                                            "return",
                                            960..966,
                                        ),
                                        Some(
                                            (
                                                Neg(
                                                    (
                                                        "-",
                                                        967..968,
                                                    ),
                                                    (
                                                        Var(
                                                            (
                                                                "number",
                                                                968..974,
                                                            ),
                                                        ),
                                                        968..974,
                                                    ),
                                                ),
                                                968..974,
                                            ),
                                        ),
                                    ),
                                    960..974,
                                ),
                            ),
                            948..974,
                        ),
                        [],
                        None,
                    ),
                    945..974,
                ),
                (
                    Return(
                        (
                            "return",
                            979..985,
                        ),
                        Some(
                            (
                                Var(
                                    (
                                        "number",
                                        986..992,
                                    ),
                                ),
                                986..992,
                            ),
                        ),
                    ),
                    979..992,
                ),
            ],
        ),
        883..994,
    ),
]
